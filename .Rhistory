sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
vectors<-hclusters(distance,k,"complete")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
vectors<-hclusters(distance,k,"average")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster"))
View(datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")))
?dist
?dist
?dist
?hclust
?dist
?daisy
?agnes
distance<-dist(scaledata,method="manhattan")
vectors<-hclusters(distance,k,"ward.d2")
vectors<-hclusters(distance,k,method="ward.d2")
?hclust
vectors<-hclusters(distance,k,method="average")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
vectors<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
View(datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")))
distance<-dist(scaledata,method="euclidian")
vectors<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
distance<-dist(scaledata,method="euclidian")
vectors<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(vectors,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
View(datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")))
ggplot(aes(x=k,y=sil.kmeans))+geom_line()+geom_point()
silkmeans<-data.frame(k=k,sil=sil.kmeans)
silkmeans<-data.frame(k=k[2:6],sil=sil.kmeans)
ggplot(aes(x=k,y=sil))+geom_line()+geom_point()
ggplot(data=silkmeans,aes(x=k,y=sil))+geom_line()+geom_point()
pambest<-pamk(scaledata,krange=2:6)
install.packages("fpc")
library("fpc")
pambest<-pamk(scaledata,krange=2:6)
multiplehist2<-function(data,color){
numeric<-map_lgl(data,is.numeric)
newdata<-data[,numeric]
aux<- function(data,column,color){
a<-ggplot(data=data,mapping=aes_string(x=column,color=color))+geom_density()+labs(x=column)
return(a)
}
colnames(newdata)
lista<-map(colnames(newdata),~aux(newdata,.))
return(lista)
}
?hclust
table(datakmeans$k,datakmeans$cluster)
kmeans.results<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-kmeans(data,nstart = 30,centers = k)
return(list(vec$tot.withinss,vec$cluster))
}
return(map(k,~aux(data,.)))
}
a<-kmeans.results(scaledata,k)
a
a[1][2]
a[1][1]
a[1]
a[1][2]
a[[1]][1]
b<-map(k,a[[.]][1])
b<-map(k,~a[[.]][1])
b<-map_dbl(k,~a[[.]][1])
library(tidyverse)
library(cluster)
library(factoextra)
library(NbClust)
source("r/functions.R")
kmeans.results<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-kmeans(data,nstart = 30,centers = k)
return(list(c(vec$tot.withinss,vec$cluster)))
}
return(map(k,~aux(data,.)))
}
dataset<-read_csv("data/HTRU_2bis.csv")
names(dataset)<-c("X","meanip","sdip","kurtip",
"skewip","meandm","sddm",
"kurtdm","skewdm")
dataset<-select(dataset,-X)
normdata<-as.data.frame(scale(dataset[,]))
k<-c(1:6)
colnames<-c("One","Two","Three","Four","Five","Six")
kmeans<-kmeans.results(normdata,k)
kmeans
kmeans.results<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-kmeans(data,nstart = 30,centers = k)
return(list(vec$tot.withinss,vec$cluster))
}
return(map(k,~aux(data,.)))
}
kmeans.results<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-kmeans(data,nstart = 30,centers = k)
return(list(vec$tot.withinss,vec$cluster))
}
return(map(k,~aux(data,.)))
}
kmeans<-kmeans.results(normdata,k)
kmeans[[1]][1]
kmeans<-kmeans.results(normdata,k)
kmeans[[2]][1]
kmeans<-kmeans.results(normdata,k)
kmeans[[2]][1]
kmeansclusters<-map_df(k,kmeans[[.]][2])
kmeansclusters<-map_df(k,~kmeans[[.]][2])
kmeansclusters<-as.data.frame(map(k,~kmeans[[.]][2]))
View(kmeansclusters)
View(kmeansclusters)
datakmeans<-addclustdf(data = datapca,vectors = kmeansclusters,k = k,
colnames = colnames)
pca<-prcomp(dataset,scale=TRUE)
datapca<-bind_cols(dataset,as.data.frame(pca$x))
datakmeans<-addclustdf(data = datapca,vectors = kmeansclusters,k = k,
colnames = colnames)
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col()
kmeansquares<-map_dbl(k,~kmeans[[.]][1])
kmeansquares<-map(k,~kmeans[[.]][1])
kmeansquares<-as.vector(map(k,~kmeans[[.]][1]))
kmeansquares<-as.data.frame(map(k,~kmeans[[.]][1]))
kmeansquares<-map_int(k,~kmeans[[.]][1]))
kmeansquares<-map_int(k,~kmeans[[.]][1])
kms<-as.data.frame(map(k,~kmeans[[.]][1]))
kss<-data.frame(k=k,ss=kms)
ggplot(kss,aes(x=k,y=ss))+geom_line()+geom_point()
kms<-as.integer(map(k,~kmeans[[.]][1]))
kms<-map(k,~kmeans[[.]][1]))
kms<-map(k,~kmeans[[.]][1])
kms<-map(kms,as.vector)
kms<-map_dbl(kms,as.vector)
kms<-flatten(kms)
kms<-flatten(map(k,~kmeans[[.]][1]))
kss<-data.frame(k=k,ss=kms)
ggplot(kss,aes(x=k,y=ss))+geom_line()+geom_point()
kss<-data.frame(k=k,ss=as.integer(kms))
ggplot(kss,aes(x=k,y=ss))+geom_line()+geom_point()
ggplot(data=datakmeans,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)
summarykmeans<-datakmeans %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datakmeans %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
ggplot(data=summarykmeans,aes(x=cluster,y=count))+geom_bar()
ggplot(data=summarykmeans,aes(x=cluster,y=count))+geom_vol()
ggplot(data=summarykmeans,aes(x=cluster,y=count))+geom_col()
ggplot(data=summarykmeans,aes(x=cluster,y=k,fill=cluster))+geom_col(position="dodge")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge",stat="density")
ggplot(data=datakmeans,aes(x=kurtip,color=cluster))+geom_density()+
facet_wrap(~k,ncol=3)
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge",stat="density")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
summarykmeans<-datakmeans %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datakmeans %>%
group_by_("k","cluster") %>%
summarize(count=n(),countpct=n()/nrow(dataset)),by=c("k","cluster")) %>%
select(1:2,19,3:18)
summarykmeans<-datakmeans %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datakmeans %>%
group_by_("k","cluster") %>%
summarize(count=n(),countpct=n()/nrow(dataset)),by=c("k","cluster")) %>%
select(1:2,19,20,3:18)
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")+
geom_text(aes(label=countpct,color="white"))
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")+
geom_text(aes(label=round(countpct,2)),color="white")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")+
geom_text(aes(label=round(countpct,2)),color="black")
library(ggrepel)
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")+
geom_text_repel(aes(label=round(countpct,2)),color="black")
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")+
#plots
ggplot(data=datakmeans,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)
ggplot(data=summarykmeans,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
ggplot(data=datakmeans,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)
fviz_cluster(kmeans(normdata,k=3))
fviz_cluster(kmeans(normdata,nstart=30,centers=3),normdata)
ggplot(data=datakmeans,aes(x=kurtip,color=cluster))+geom_density()+
facet_wrap(~k,ncol=3)
multiplehist2<-function(data,color){
numeric<-map_lgl(data,is.numeric)
newdata<-data[,numeric]
aux<- function(data,column,color){
a<-ggplot(data=data,mapping=aes_string(x=column,color=color))+geom_density()+labs(x=column)
return(a)
}
colnames(newdata)
lista<-map(colnames(newdata),~aux(newdata,.))
return(lista)
}
plotlist<-multiplehist2(datakmeans %>% filter(k=="K=2") %>%
select(c(1:8,17,18)),"cluster")
plotlist<-multiplehist2(datakmeans %>% filter(k=="K=2") %>%
select(c(1:8,17,18)),"cluster")
plotlist<-datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist("cluster")
plotlist<-datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
multiplehist2<-function(data,color){
numeric<-map_lgl(data,is.numeric)
newdata<-data[,numeric]
aux<- function(data,column,color){
a<-ggplot(data=data,mapping=aes_string(x=column,color=color))+geom_density()+labs(x=column)
return(a)
}
colnames(newdata)
lista<-map(colnames(newdata),~aux(newdata,.,color))
return(lista)
}
plotlist<-datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
plotlist[[1]]
plotlist<-datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18))
multiplehist2<-function(data,color){
numeric<-map_lgl(data,is.numeric)
newdata<-data[,numeric]
aux<- function(data,column,color){
a<-ggplot(data=data,mapping=aes_string(x=column,color=color))+geom_density()+labs(x=column)
return(a)
}
colnames(newdata)
lista<-map(colnames(newdata),~aux(data,.,color))
return(lista)
}
plotlist<-datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
plotlist[[1]]
plotlist[[2]]
multiplot(list=plotlist,cols=3)
multiplot(plotlist=plotlist,cols=3)
datakmeans %>%
filter(k=="K=2") %>%
select(c(1:8,17,18))
multiplot(plotlist=plotlist,cols=3)
ggplot(data=datakmeans,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("K-Means Clustering")
ggplot(data=datakmeans,aes(x=kurtip,color=cluster))+geom_density()+
facet_wrap(~k,ncol=3)
ggplot(data=silkmeans,aes(x=k,y=sil))+geom_line()+geom_point()+
geom_title("Silhouette K-Means")
silkmeans<-data.frame(k=k[2:6],sil=sil.kmeans)
sil.kmeans<-sil.clust(kmeansclusters,distance,k[2:6])
sil.kmeans<-sil.clust(kmeansclusters,distance,k[2:6])
distance<-dist(scaledata,method="euclidian")
distance<-dist(normdata,method="euclidian")
sil.kmeans<-sil.clust(kmeansclusters,distance,k[2:6])
silkmeans<-data.frame(k=k[2:6],sil=sil.kmeans)
ggplot(data=silkmeans,aes(x=k,y=sil))+geom_line()+geom_point()+
geom_title("Silhouette K-Means")
ggplot(data=silkmeans,aes(x=k,y=sil))+geom_line()+geom_point()+
ggtitle("Silhouette K-Means")
ggplot(data=silkmeans,aes(x=k,y=silhouette))+geom_line()+geom_point()+
ggtitle("Silhouette K-Means")
silkmeans<-data.frame(k=k[2:6],silhouette=sil.kmeans)
ggplot(data=silkmeans,aes(x=k,y=silhouette))+geom_line()+geom_point()+
ggtitle("Silhouette K-Means")
hclust<-hclust(distance,method="ward.D2")
plot(hclust,hang=-1,labels=FALSE)
topclusters<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(topclusters,distance,k[2:6])
sil.hclust
topclusters<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(topclusters,distance,k[2:6])
sil.hclust
summaryhclust<-datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")))
summaryhclust<-datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster"))
datahclust<-addclustdf(data = datapca,vectors = vectors,k = k,
colnames = colnames)
datahclust<-addclustdf(data = datapca,vectors = hclusters,k = k,
colnames = colnames)
hclusters<-hclusters(distance,k,method="ward.D2")
sil.hclust<-sil.clust(hclusters,distance,k[2:6])
sil.hclust
datahclust<-addclustdf(data = datapca,vectors = hclusters,k = k,
colnames = colnames)
ggplot(data=datahclust,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("Ward Clustering")
plotlist<-datahclust %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
multiplot(plotlist=plotlist,cols=3)
silhclust<-data.frame(k=k[2:6],silhouette=sil.hclust)
ggplot(data=silhclust,aes(x=k,y=silhouette))+geom_line()+geom_point()+
ggtitle("Silhouette Bottom-Up Clustering")
summaryhclust<-datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,20,3:18)
summaryhclust<-datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster"))
select(1:2,19,3:18)
summaryhclust<-datahclust %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
summarykmeans<-datakmeans %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datakmeans %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
ggplot(data=summaryhclust,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
plotlist<-datahclust %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
multiplot(plotlist=plotlist,cols=3)
pambest<-pam(normdata,k=2)
names(pambest)
pambest<-pam(normdata,k=6)
pamk2<-pam(x = distance,k = 2)
pamk2$silinfo
pamk2$clustering
datapam<-addclustdf(data = datapca,vectors = pamk2$clustering,k = 2,
colnames = "Two")
datapam<-addclustdf(data = datapca,vectors = as.data.frame(pamk2$clustering),k = 2,
colnames = "Two")
pamk2<-pam(x = distance,k = 3)
pamk2<-pam(x = distance,k = 2)
pamk2<-pam(x = distance,k = 1)
pam.clusters<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-pam(data,centers = k)
return(vec$clustering)
}
return(map(k,~aux(data,.)))
}
pamclust<-pam.clusters(distance,c(1:3))
pam.clusters<-function(data,k){
aux<-function(data,k){
set.seed(1234)
vec<-pam(data,k=k)
return(vec$clustering)
}
return(map(k,~aux(data,.)))
}
pamclust<-pam.clusters(distance,c(1:3))
datapam<-addclustdf(data = datapca,vectors = as.data.frame(pamclust),k = c(1:3),
colnames = c("One","Two","Three"))
sil.pam<-sil.clust(pamclust,distance,k[2:3])
sil.pam<-sil.clust(pamclust,distance,k[2:3])
silpam<-data.frame(k=k[2:3],silhouette=sil.pam)
ggplot(data=silpam,aes(x=k,y=silhouette))+geom_line()+geom_point()+
ggtitle("Silhouette PAM")
ggplot(data=datapam,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("PAM Clustering")
summarypam<-datapam %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datahclust %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
summarypam<-datapam %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datapam %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
ggplot(data=summarypam,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
plotlist<-datapam %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
multiplot(plotlist=plotlist,cols=3)
plotlistpam<-datapam %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
pamclust<-pam.clusters(distance,k)
pamclust<-as.data.frame(pamclust)
write_csv("output/pamclust.csv",pamclust)
pamclust<-as.data.frame(pamclust)
pamclust
names(pamclust)<-colnames
write_csv("output/pamclust.csv",pamclust)
str(pamclust)
write.csv("output/pamclust.csv",pamclust)
sil.pam<-sil.clust(pamclust,distance,k[2:6])
silpam<-data.frame(k=k[2:6],silhouette=sil.pam)
ggplot(data=silpam,aes(x=k,y=silhouette))+geom_line()+geom_point()+
ggtitle("Silhouette PAM")
datapam<-addclustdf(data = datapca,vectors = as.data.frame(pamclust),k = c(1:6),
colnames = colnames)
write_csv("output/datapam.csv",datapam)
write_csv("./output/datapam.csv",datapam)
write_csv("output/datapam.csv",datapam)
names(pamclust)<-colnames
write_csv(pamclust,"output/pamclust.csv")
datapam<-addclustdf(data = datapca,vectors = as.data.frame(pamclust),k = c(1:6),
colnames = colnames)
ggplot(data=datapam,aes(x=PC1,y=PC2,color=cluster))+geom_point()+
facet_wrap(~k,ncol=3)+ggtitle("PAM Clustering")
summarypam<-datapam %>%
group_by_("k","cluster") %>%
summarize_all(mean) %>%
left_join(datapam %>%
group_by_("k","cluster") %>%
summarize(count=n()),by=c("k","cluster")) %>%
select(1:2,19,3:18)
ggplot(data=summarypam,aes(x=k,y=count,fill=cluster))+geom_col(position="dodge")
plotlistpam<-datapam %>%
filter(k=="K=2") %>%
select(c(1:8,17,18)) %>%
multiplehist2("cluster")
multiplot(plotlist=plotlistpam,cols=3)
